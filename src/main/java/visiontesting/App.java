/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package visiontesting;

import org.opencv.core.Core;
import org.opencv.core.Mat;
import org.opencv.videoio.VideoCapture;
import org.opencv.imgcodecs.Imgcodecs;

public class App {
    public static boolean cameraActive = true;

    public String getGreeting() {
        return "Hello world, lolz.";
    }

    public static void main(String[] args) {
        // TODO: Make a proper command line parser
        // * Parser needs to take image, draw-boolean, and camera id.
        System.loadLibrary(Core.NATIVE_LIBRARY_NAME);
        System.out.println(new App().getGreeting());
        VideoCapture camera = new VideoCapture(1);
        Mat frame = new Mat();
        if (args.length != 0) {
            cameraActive = false;
            frame = Imgcodecs.imread(args[0]);
        }
        Imshow im = new Imshow("Video Preview");
        Detector detector = new Detector(true);
        im.Window.setResizable(true);
        while (true) {
            if (cameraActive) {
                camera.read(frame);
            }
            System.out.println(detector.detect2019Targets(frame).size());
            im.showImage(frame);
        }
    }
}
